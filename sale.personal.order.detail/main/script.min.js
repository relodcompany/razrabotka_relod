BX.namespace("BX.Sale.PersonalOrderComponent"),BX.Sale.PersonalOrderComponent.PersonalOrderDetail=function(e,t){this.init(e,t)},BX.Sale.PersonalOrderComponent.PersonalOrderDetail.prototype={node:null,id:0,init:function(e,t){this.node=document.querySelector(e),BX.type.isPlainObject(t)&&(this.id=t.id),this.node&&(BX.bindDelegate(this.node,"click",{className:"order__info__items-toggle"},BX.proxy((function(e){let t=(e=e||window.event).target.closest(".order__info__items-toggle");if(t){let e=t.previousElementSibling;if(e){BX.toggleClass(e,"open");let o=e.classList.contains("open");t.textContent=BX.message(o?"SPOD_TOGGLE_CLOSE":"SPOD_TOGGLE_OPEN")}}}),this)),BX.bindDelegate(this.node,"click",{className:"show_on_map"},BX.proxy((function(e){let t=(e=e||window.event).target.closest(".show_on_map");if(t){let e=t.closest(".order__info");if(e){let t=e.querySelector(".store__map-wrapper");t&&t.classList.toggle("hidden")}}}),this)),BX.bindDelegate(this.node,"click",{className:"js-show-shipment-products"},BX.proxy((function(e){(e=e||window.event).preventDefault();let t=e.target.closest(".js-show-shipment-products");if(t){let e=t.closest(".order__info");if(e){let t=e.querySelector(".order__cart__items");t&&t.classList.toggle("hidden")}}}),this)),BX.bindDelegate(this.node,"click",{className:"order__card__button--pay"},BX.proxy((function(e){(e=e||window.event).preventDefault(),scrollToBlock("#order__payments")}),this)),BX.addCustomEvent("onOrderPaymentChange",BX.proxy((function(e){if("object"==typeof e&&e&&e.orderId==this.id){let e=document.getElementById("order__payments");if(e&&e.classList.add("loading-state-before"),"#order__payments"!==location.hash){let e=location.href.replace(location.hash,"")+"#order__payments";"undefined"!=typeof history?history.replaceState(null,null,e):location.href=e}location.reload()}}),this)),BX.bindDelegate(this.node,"click",{className:"js-pay-payment"},BX.proxy((function(e){(e=e||window.event).preventDefault();let t=e.target.closest(".js-pay-payment");if(t){let e=t.closest(".order__info");if(e){let o=e.querySelector(".order__info__payment-template");if(o){t.classList.add("loadings");let e=o.content.cloneNode(!0),s=BX.create({tag:"DIV"});s.append(e);let n=BX.create({tag:"div",attrs:{"data-event":"jqm","data-name":"message","data-param-form_id":"message","data-param-message_title":encodeURIComponent(t.dataset.title||""),"data-param-message_button_title":"","data-param-message_button_class":""}});BX.append(n,document.body),$(n).jqmEx(BX.proxy((function(e,o,n){t&&t.classList.remove("loadings");let a=o.w[0];if(a){a.classList.add("popup--order-pay");let e=a.querySelector(".form-body");if(e){let t=BX.processHTML(s.innerHTML),o=t.HTML.trim();e.innerHTML=o,BX.ajax.processScripts(t.SCRIPT)}}}),this),BX.proxy((function(e,o,s){t&&t.classList.remove("loadings")}),this)),arAsproOptions.SITE_TEMPLATE_PATH_MOBILE||BX.fireEvent(n,"click"),n.remove()}}}}),this)))}};